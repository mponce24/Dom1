<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Solucionador y Graficador de Ecuaciones</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: #fff;
      margin: 0;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      box-sizing: border-box;
    }
    h1 {
      margin-bottom: 1rem;
      text-shadow: 1px 1px 4px rgba(0,0,0,0.3);
    }
    #ecuacion {
      width: 100%;
      max-width: 480px;
      padding: 0.75rem 1rem;
      font-size: 1.1rem;
      border-radius: 8px;
      border: none;
      box-shadow: 0 0 8px rgba(0,0,0,0.2);
      margin-bottom: 1rem;
      outline: none;
    }
    button {
      cursor: pointer;
      font-size: 1.1rem;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      margin: 0.5rem 0;
      width: 100%;
      max-width: 480px;
      background: #ff6f61;
      color: white;
      font-weight: 600;
      box-shadow: 0 4px 10px rgba(255,111,97,0.5);
      transition: background 0.3s ease;
    }
    button:hover {
      background: #ff3b2f;
      box-shadow: 0 6px 14px rgba(255,59,47,0.7);
    }
    #resultado {
      background: rgba(255 255 255 / 0.15);
      max-width: 480px;
      width: 100%;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      margin-top: 1rem;
      line-height: 1.5;
      font-size: 1.1rem;
      min-height: 110px;
      user-select: none;
    }
    canvas {
      margin-top: 2rem;
      max-width: 600px;
      max-height: 400px;
      width: 100%;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      background: white;
    }
  </style>
</head>
<body>
  <h1>Solucionador y Graficador de Ecuaciones</h1>
  <input id="ecuacion" type="text" placeholder="Ejemplo: 1/2x^2 - 3/4x + 1" autocomplete="off" />
  <button onclick="resolver()">Resolver y Graficar</button>
  <button onclick="leerResultado()" style="background:#4caf50;">üîä Escuchar Resultado</button>

  <div id="resultado"></div>
  <canvas id="grafico"></canvas>

  <script>
    let grafico;
    let textoResultado = '';

    function resolver() {
      const input = document.getElementById('ecuacion').value.trim();
      const resultadoDiv = document.getElementById('resultado');
      const ctx = document.getElementById('grafico').getContext('2d');

      if (!input) {
        resultadoDiv.innerHTML = '<p style="color:#ffb3b3;">Por favor ingresa una ecuaci√≥n v√°lida.</p>';
        textoResultado = '';
        if(grafico) grafico.destroy();
        return;
      }

      // Convertir fracciones a decimal
      let expr = input.replace(/\^/g, '**');
      expr = expr.replace(/(-?\d+\/\d+)/g, (match) => {
        const [num, den] = match.split('/');
        return `(${parseFloat(num) / parseFloat(den)})`;
      });

      try {
        const a = obtenerCoef(expr, 'x\\*\\*2');
        const b = obtenerCoef(expr, '(?<!\\*)x(?!\\*)');
        const c = obtenerConstante(expr);

        const tipo = a !== 0 ? 'Cuadr√°tica' : 'Lineal';
        const dominio = 'Todos los n√∫meros reales (-‚àû, ‚àû)';
        let rango = '';
        let solucion = '';

        if (tipo === 'Cuadr√°tica') {
          const discriminante = b*b - 4*a*c;
          const verticeX = -b/(2*a);
          const verticeY = a*verticeX*verticeX + b*verticeX + c;
          rango = a > 0 ? `[${verticeY.toFixed(2)}, ‚àû)` : `(-‚àû, ${verticeY.toFixed(2)}]`;

          if (discriminante > 0) {
            const x1 = (-b + Math.sqrt(discriminante)) / (2*a);
            const x2 = (-b - Math.sqrt(discriminante)) / (2*a);
            solucion = `Soluciones reales: x‚ÇÅ = ${x1.toFixed(3)}, x‚ÇÇ = ${x2.toFixed(3)}`;
          } else if (discriminante === 0) {
            const x = -b / (2*a);
            solucion = `Soluci√≥n √∫nica: x = ${x.toFixed(3)}`;
          } else {
            const real = (-b / (2*a)).toFixed(3);
            const imag = (Math.sqrt(-discriminante) / (2*a)).toFixed(3);
            solucion = `Soluciones complejas: ${real} ¬± ${imag}i`;
          }
        } else {
          if (b === 0) {
            if (c === 0) solucion = 'Soluci√≥n infinita (0=0)';
            else solucion = 'No tiene soluci√≥n';
          } else {
            const x = -c / b;
            solucion = `Soluci√≥n: x = ${x.toFixed(3)}`;
          }
          rango = 'Todos los n√∫meros reales (-‚àû, ‚àû)';
        }

        textoResultado = `Tipo: ${tipo}. Dominio: ${dominio}. Rango: ${rango}. ${solucion}.`;
        resultadoDiv.innerHTML = `
          <p><strong>Tipo:</strong> ${tipo}</p>
          <p><strong>Dominio:</strong> ${dominio}</p>
          <p><strong>Rango:</strong> ${rango}</p>
          <p><strong>${solucion}</strong></p>
        `;

        // Graficar funci√≥n
        const xs = [];
        const ys = [];
        for (let i = -20; i <= 20; i += 0.1) {
          xs.push(i);
          ys.push(a*i*i + b*i + c);
        }

        if (grafico) grafico.destroy();
        grafico = new Chart(ctx, {
          type: 'line',
          data: {
            labels: xs,
            datasets: [{
              label: 'f(x)',
              data: ys,
              borderColor: '#ff6f61',
              borderWidth: 3,
              fill: false,
              pointRadius: 0,
              tension: 0.2
            }]
          },
          options: {
            responsive: true,
            scales: {
              x: {
                min: -20,
                max: 20,
                title: { display: true, text: 'x' },
                grid: { color: '#ccc' }
              },
              y: {
                min: -20,
                max: 20,
                title: { display: true, text: 'f(x)' },
                grid: { color: '#ccc' }
              }
            },
            plugins: {
              legend: { display: false },
              title: {
                display: true,
                text: 'Gr√°fica de la funci√≥n'
              }
            }
          }
        });

      } catch(e) {
        resultadoDiv.innerHTML = '<p style="color:#ffb3b3;">Error al analizar la ecuaci√≥n. Verifica la sintaxis.</p>';
        textoResultado = '';
        if(grafico) grafico.destroy();
      }
    }

    function obtenerCoef(expr, variableRegex) {
      const re = new RegExp('([-+]?\\(?[\\d\\.]+\\)?)*\\*?' + variableRegex);
      const match = expr.match(re);
      if (!match) return 0;
      let val = match[1];
      if (!val || val === '+' || val === '') return 1;
      if (val === '-') return -1;
      try {
        return eval(val);
      } catch {
        return parseFloat(val) || 0;
      }
    }

    function obtenerConstante(expr) {
      const exprSinX = expr.replace(/[-+]?\\(?\\d*\\.?\\d*\\)?\\*?x(\\*\\*\\d+)?/g, '');
      const matches = exprSinX.match(/[-+]?\\d*\\.?\\d+/g);
      if (!matches) return 0;
      return matches.map(Number).reduce((a,b) => a + b, 0);
    }

    function leerResultado() {
      if (!textoResultado) {
        alert('No hay resultado para leer.');
        return;
      }
      if ('speechSynthesis' in window) {
        const voz = new SpeechSynthesisUtterance(textoResultado);
        voz.lang = 'es-ES';
        speechSynthesis.speak(voz);
      } else {
        alert('Tu navegador no soporta s√≠ntesis de voz.');
      }
    }
  </script>
</body>
</html>


